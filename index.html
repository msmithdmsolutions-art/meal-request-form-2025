<!DOCTYPE html>
<html>
<head>
  <title>Check Delivery Distance</title>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAV0P1ms-rtH_nEFDST5EB0WpbZCw4dESA&libraries=places"></script>
  <script>
    let autocomplete;
    let selectedPlace = null;
    const originAddress = "8908 Smokey Drive, Plano, TX 75025";
    const maxDistanceMeters = 16093; // 10 miles

    function initAutocomplete() {
      const input = document.getElementById("address");
      autocomplete = new google.maps.places.Autocomplete(input, { types: ['address'] });
      autocomplete.addListener('place_changed', () => {
        selectedPlace = autocomplete.getPlace();
        if (!selectedPlace.geometry) {
          selectedPlace = null; // reset if no geometry
        }
      });
    }

    function checkDistance() {
      if (!selectedPlace) {
        alert("Please select a valid address from the dropdown.");
        return;
      }

      const destination = selectedPlace.formatted_address;
      const service = new google.maps.DistanceMatrixService();
      service.getDistanceMatrix(
        {
          origins: [originAddress],
          destinations: [destination],
          travelMode: 'DRIVING',
        },
        (response, status) => {
          if (status !== 'OK') {
            alert('Error with distance matrix: ' + status);
            return;
          }
          const element = response.rows[0].elements[0];
          if (element.status !== 'OK') {
            alert('Could not calculate distance to this address.');
            return;
          }

          const distanceMeters = element.distance.value;
          if (distanceMeters <= maxDistanceMeters) {
            alert("Address is within delivery area!");
          } else {
            alert("Sorry, address is outside our delivery area.");
          }
        }
      );
    }
  </script>
</head>
<body onload="initAutocomplete()">
  <h1>Check Delivery Distance</h1>
  <input id="address" placeholder="Enter your address" type="text" style="width: 300px;" autocomplete="off" />
  <button onclick="checkDistance()">Check Distance</button>
</body>
</html>
